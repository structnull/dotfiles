# Gaming - Fullscreen and performance
windowrule {
  name = fullscreen
  match:class = ^(mpv|gamescope|soh\.elf)$
  
  fullscreen = on
  no_blur = on
}

windowrule {
  name = cs2
  match:class = ^(cs2)$
  immediate = on
}

windowrule {
  name = benchmark-immediate
  match:title = ^(glxgears|vkcubepp|hl_linux)$
  immediate = on
}

# Media players - Float
windowrule {
  name = media-players
  match:class = ^(io\.github\.celluloid_player\.Celluloid)$
  float = on
}

# Opacity settings
windowrule {
  name = opacity-chat
  match:class = ^(Spotify|vesktop)$
  opacity = 0.70 0.60
}

windowrule {
  name = opacity
  match:class = ^(code-oss|codium|pcmanfm-qt|org.kde.polkit-kde-authentication-agent-1)$
  opacity = 0.85 0.80
}

# Special window behaviors
windowrule = match:class ^(winecfg\.exe)$, no_max_size on
windowrule = match:class ^(.*rnote.*)$, group deny
windowrule = match:class ^(org.kde.kcalc)$, float on

# XWaylandVideoBridge (commented out)
# windowrule {
#   name = xwayland-bridge
#   match:class = ^(xwaylandvideobridge)$
#   
#   opacity = 0.0 override 0.0 override
#   no_anim = on
#   no_focus = on
#   no_initial_focus = on
# }

# Common modal dialogs - Float
windowrule {
  name = modal-dialogs
  match:title = ^(Open|Authentication Required|Add Folder to Workspace|Choose Files|Save As|Confirm to replace files|File Operation Progress)$
  
  float = on
}

windowrule {
  name = file-dialogs
  match:title = ^(File Upload|Choose wallpaper|Library|Media viewer)(.*)$
  
  float = on
}

windowrule {
  name = dialog-titles
  match:title = ^(.*dialog.*)$
  
  float = on
}

windowrule {
  name = portal-dialogs
  match:class = ^([Xx]dg-desktop-portal-(gtk|kde)|org.freedesktop.impl.portal.desktop.kde)$
  float = on
}

windowrule {
  name = dialog-classes
  match:class = ^(.*dialog.*)$
  
  float = on
}

windowrule {
  name = pip-windows
  match:title = ^(Picture-in-Picture)$
  float = on
  pin = on
}

windowrule {
  name = float-dialogs
  match:modal = true
  float = on
  center = on
  animation = popin
  dim_around = on
}

windowrule {
  name = float-utility
  match:title = ^(Preferences|Settings|Options|About)$
  float = on
  center = on
}

windowrule {
  name = dolphin-progress
  match:class = ^(org.kde.dolphin)$
  match:title = ^(Progress Dialog — Dolphin|Copying — Dolphin)$
  
  float = on
}

# Firefox specific
windowrule {
  name = firefox-float
  match:class = ^(firefox)$
  match:title = ^(About Mozilla Firefox|Picture-in-Picture|Library)$
  
  float = on
}

windowrule {
  name = firefox-sharing-indicator
  match:class = ^(firefox)$
  match:title = ^(Firefox — Sharing Indicator)$
  
  workspace = special silent
}

windowrule {
  name = sharing-indicator-generic
  match:title = ^(.*is sharing (your screen|a window)\.)$
  
  workspace = special silent
}

windowrule {
  name = firefox-youtube-idle
  match:class = ^(firefox)$
  match:title = ^(.*YouTube.*)$
  
  idle_inhibit = focus
}

windowrule {
  name = firefox-fullscreen-idle
  match:class = ^(firefox)$
  match:fullscreen = 1
  
  idle_inhibit = focus
}

# Screen share blocking
windowrule {
  name = no-share-apps
  match:class = ^(vesktop|org.keepassxc.KeePassXC)$
  
  no_screen_share = on
}

windowrule {
  name = no-share-whatsapp
  match:title = ^(.*[Ww]hatsApp.*)$
  
  no_screen_share = on
}

windowrule {
  name = no-share-inbox
  match:title = ^(.*)(\) Inbox|Inbox|All mail)(.*)$
  
  no_screen_share = on
}

# Idle inhibit - Media and games
windowrule {
  name = idle-inhibit-media
  match:class = ^(mpv|.+exe|org.kde.haruna|looking-glass-client|gamescope)$
  
  idle_inhibit = focus
}

windowrule {
  name = idle-inhibit-steam
  match:class = ^(steam_app.*|steam_proton.*)$
  
  idle_inhibit = focus
}

windowrule {
  name = looking-glass-fullscreen
  match:class = ^(looking-glass-client)$
  match:fullscreen = 1
  
  idle_inhibit = focus
}

# Discord/Communication apps
windowrule {
  name = discord-workspace
  match:title = ^(.*(Disc|WebC)ord.*)$
  
  workspace = 5 silent
}

windowrule {
  name = discord-screenaudio-workspace
  match:class = ^(de.shorsh.discord-screenaudio)$
  
  workspace = 5 silent
}

# Steam fixes
windowrule {
  name = steam-minsize
  match:title = ^()$
  match:class = ^(steam)$
  
  min_size = 1 1
}

windowrule {
  name = empty-window-noblur
  match:class = ^()$
  match:title = ^()$
  
  no_blur = on
}

# Global fixes
windowrule {
  name = suppress-maximize
  match:class = .*
  
  suppress_event = maximize
}

windowrule {
  name = xwayland-drag-fix
  match:class = ^$
  match:title = ^$
  match:xwayland = 1
  match:float = 1
  match:fullscreen = 0
  match:pin = 0
  no_focus = on
}

windowrule {
  name = pinentry-focus
  match:class = (pinentry-)(.*)
  
  stay_focused = on
}

# Layer rules for UI elements ["search layers using hyprctl layers"]
layerrule {
  name = interactive
  match:namespace = ^(rofi|vicinae)$

  blur = on
  blur_popups = on
  animation = popin
  ignore_alpha = 0.0
  dim_around = on
  order = 10
}

layerrule {
  name = ui-persistent
  match:namespace = ^(waybar|swaync-control-center|logout_dialog)$
  blur = on
  ignore_alpha = 0.25
  order = 5
}

layerrule {
  name = notifications
  match:namespace = ^(swaync-notification-window)$
  blur = on
  ignore_alpha = 0.35
  animation = slide
  order = 8
}

layerrule {
  name = no-screen-share 
  match:namespace = ^(vicinae|logout_dialog|swaync-control-center)$
  no_screen_share = on
}

